{% extends "Tracker/base.html" %}

{% block title %} Task Screen{% endblock %}
{% load my_tags %}

{% block content %}
		<h1>Task View </h1>
        
		<form action="{% url 'edit_task' task.id %}" method="post">
			{% csrf_token %}
			<table>
				<tr>
					<td  hidden>{{form.tproject}}</td>

				<tr>
                    <th>Sprint : </th>
					<td>{{form.tsprint}}</td>
				</tr>
				<tr>
					<th>Name : </th>
					<td> {{ form.tname }}</td>
				</tr>

				</tr>            
				<tr>
					<th>Description : </th>
					<td> {{ form.desc }}</td>
				</tr>
                
                
				<tr><th>Due date :</th><td> {{form.due_date}}</td></tr>
				<tr>
                <th></th>
					<td>{% if days >= 0 %}
                    {{days}} Day{% if days > 1 %}s{% endif %}
                    left
                    {% else %}
                    Task is Overdue
                    {% endif %}
                    </td>
				<tr><th>Risk :</th><td>  {{ form.risk }}</td></tr>
				<tr><th>Priority : </th><td> {{ form.priority }}</td></tr>
				<tr><th>State : </th><td> {{ form.state }}</td></tr>
				<tr><th>Assignee :</th><td> {{form.assign }}</td></tr>
				<tr><th>Remainder :</th><td> {{form.remainder}}</td></tr>
				<tr><th>Heading :</th><td> {{form.heading}}</td></tr>
				<tr><th>Dependent task :</th><td> {{form.dep_task}}</td></tr>
				<tr><th>Task Points :</th><td> {{form.tp}}</td></tr>
			</table>
		   	<input type="submit" value="Submit" />
		</form>
		<a href="{% url 'delete_task' task.id %}" >Delete Task</a>

	<!-- COMMENTS FOR THIS TASK-->		
		<h2>Comments: </h2>
		{% if error_message %}
			<p>{{ error_message }}</p>
		{% endif %}
        
		{% for c in task.comment_set.all|dictsort:"ccreated"%}
			<p><strong>{{ c.comment }}</strong> &nbsp {{ c.ccreated|timesince|upto:','}} ago &nbsp Posted By: {{c.member}}</p>
		{% endfor %}
        
		<a href="{% url 'add_comment' task.id %}">Add Comment</a>

	<!-- TAGS FOR THIS TASK-->
		<h2>Tags associated with {{ task.tname }}</h2>
		{% if error_message %}
			<p>{{ error_message }}</p>
		{% endif %}
		{% for c in task.tag_set.all %}
    		<label>{{ c.tag }}</label>
		{% endfor %}
		<a href="{% url 'add_tag' task.id %}">Add Another Tag</a>
		<br><a href="{% url 'edit_project' task.tproject.id %}" >Back</a>
{% endblock %}